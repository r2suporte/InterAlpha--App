<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Teste Máscara CNPJ</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 50px auto;
        padding: 20px;
      }
      .test-container {
        border: 1px solid #ccc;
        padding: 20px;
        margin: 20px 0;
        border-radius: 8px;
      }
      input {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin: 10px 0;
      }
      .info {
        background: #f0f8ff;
        padding: 10px;
        border-radius: 4px;
        margin: 10px 0;
      }
      .result {
        background: #f0fff0;
        padding: 10px;
        border-radius: 4px;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <h1>Teste de Máscara CNPJ</h1>

    <div class="info">
      <h3>Informações:</h3>
      <p><strong>CNPJ válido para teste:</strong> 11.222.333/0001-81</p>
      <p><strong>Apenas dígitos:</strong> 11222333000181 (14 dígitos)</p>
      <p><strong>Com formatação:</strong> 11.222.333/0001-81 (18 caracteres)</p>
    </div>

    <div class="test-container">
      <h3>Teste 1: Input Simples (sem máscara)</h3>
      <input
        type="text"
        id="simple"
        placeholder="Digite o CNPJ sem máscara"
        maxlength="18"
      />
      <div class="result" id="simple-result">Resultado:</div>
    </div>

    <div class="test-container">
      <h3>Teste 2: Simulação da Máscara Atual</h3>
      <input type="text" id="masked" placeholder="Digite o CNPJ com máscara" />
      <div class="result" id="masked-result">Resultado:</div>
    </div>

    <div class="test-container">
      <h3>Teste 3: Contagem de Caracteres</h3>
      <input type="text" id="counter" placeholder="Digite qualquer coisa" />
      <div class="result" id="counter-result">Caracteres: 0</div>
    </div>

    <script>
      // Função para aplicar máscara CNPJ (simulando a lógica do React)
      function applyMask(inputValue, maskPattern) {
        // Remove todos os caracteres não numéricos
        const cleanValue = inputValue.replace(/\D/g, '');

        // Conta quantos dígitos a máscara espera
        const expectedDigits = maskPattern.replace(/[^09]/g, '').length;

        // Limita o valor limpo ao número de dígitos que a máscara espera
        const valueForMask = cleanValue.slice(0, expectedDigits);

        // Aplica a máscara
        let maskedValue = '';
        let valueIndex = 0;

        for (
          let i = 0;
          i < maskPattern.length && valueIndex < valueForMask.length;
          i++
        ) {
          const maskChar = maskPattern[i];

          if (maskChar === '0' || maskChar === '9') {
            // Caractere de máscara para dígito
            maskedValue += valueForMask[valueIndex];
            valueIndex++;
          } else {
            // Caractere literal da máscara
            maskedValue += maskChar;
          }
        }

        return maskedValue;
      }

      function getMascaraCpfCnpj(valor) {
        const cleanValue = valor.replace(/\D/g, '');

        if (cleanValue.length <= 11) {
          return '000.000.000-00'; // Máscara CPF
        } else {
          return '00.000.000/0000-00'; // Máscara CNPJ
        }
      }

      // Teste 1: Input simples
      document.getElementById('simple').addEventListener('input', function (e) {
        const value = e.target.value;
        document.getElementById('simple-result').textContent =
          `Resultado: "${value}" (${value.length} caracteres)`;
      });

      // Teste 2: Com máscara
      document.getElementById('masked').addEventListener('input', function (e) {
        const inputValue = e.target.value;
        const mask = getMascaraCpfCnpj(inputValue);
        const maskedValue = applyMask(inputValue, mask);

        e.target.value = maskedValue;

        document.getElementById('masked-result').innerHTML =
          `Resultado: "${maskedValue}" (${maskedValue.length} caracteres)<br>` +
          `Máscara usada: "${mask}"<br>` +
          `Dígitos limpos: "${inputValue.replace(/\D/g, '')}" (${inputValue.replace(/\D/g, '').length} dígitos)`;
      });

      // Teste 3: Contador
      document
        .getElementById('counter')
        .addEventListener('input', function (e) {
          const value = e.target.value;
          const clean = value.replace(/\D/g, '');
          document.getElementById('counter-result').textContent =
            `Caracteres: ${value.length} | Dígitos: ${clean.length}`;
        });
    </script>
  </body>
</html>
