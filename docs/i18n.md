# Internacionalização (i18n)\n\n## Visão Geral\n\nO InterAlpha suporta múltiplos idiomas para atender a uma base de usuários diversificada. Esta documentação descreve a implementação e práticas recomendadas para internacionalização na aplicação.\n\n## Estratégia de Internacionalização\n\n### 1. Bibliotecas Utilizadas\n- **next-i18next** - Para integração com Next.js\n- **react-i18next** - Para hooks e componentes de tradução\n- **i18next** - Core library para gerenciamento de recursos de idiomas\n\n### 2. Estrutura de Arquivos\n```\nsrc/\n├── lib/\n│   └── i18n/\n│       ├── locales/\n│       │   ├── pt/\n│       │   │   ├── common.json\n│       │   │   ├── dashboard.json\n│       │   │   └── ...\n│       │   ├── en/\n│       │   │   ├── common.json\n│       │   │   ├── dashboard.json\n│       │   │   └── ...\n│       │   └── es/\n│       │       ├── common.json\n│       │       ├── dashboard.json\n│       │       └── ...\n│       ├── config.ts\n│       └── index.ts\n├── app/\n│   ├── [locale]/\n│   │   ├── page.tsx\n│   │   ├── layout.tsx\n│   │   └── ...\n│   └── ...\n└── ...\n```\n\n## Configuração\n\n### 1. Configuração do i18n\n```typescript\n// src/lib/i18n/config.ts\nexport const i18n = {\n  defaultLocale: 'pt',\n  locales: ['pt', 'en', 'es'],\n  localeDetection: false,\n} as const;\n\nexport type Locale = (typeof i18n)['locales'][number];\n```\n\n### 2. Inicialização\n```typescript\n// src/lib/i18n/index.ts\nimport i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport { i18n as i18nConfig } from './config';\n\n// Importar recursos de tradução\nimport commonPt from './locales/pt/common.json';\nimport commonEn from './locales/en/common.json';\nimport commonEs from './locales/es/common.json';\n\nconst resources = {\n  pt: { common: commonPt },\n  en: { common: commonEn },\n  es: { common: commonEs },\n};\n\ni18n\n  .use(initReactI18next)\n  .init({\n    resources,\n    lng: i18nConfig.defaultLocale,\n    fallbackLng: i18nConfig.defaultLocale,\n    ns: ['common'],\n    defaultNS: 'common',\n    interpolation: {\n      escapeValue: false,\n    },\n  });\n\nexport default i18n;\n```\n\n## Implementação em Componentes\n\n### 1. Usando o Hook `useTranslation`\n```tsx\n'use client'\nimport { useTranslation } from 'react-i18next';\n\nexport default function DashboardHeader() {\n  const { t } = useTranslation('dashboard');\n  \n  return (\n    <h1>{t('welcomeMessage')}</h1>\n    <p>{t('description', { name: 'João' })}</p>\n  );\n}\n```\n\n### 2. Componente `Trans` para Textos Complexos\n```tsx\nimport { Trans, useTranslation } from 'react-i18next';\n\nexport default function TermsOfService() {\n  const { t } = useTranslation('legal');\n  \n  return (\n    <p>\n      <Trans i18nKey=\"acceptTerms\">\n        Eu aceito os <a href=\"/terms\">termos de serviço</a> e a <a href=\"/privacy\">política de privacidade</a>.\n      </Trans>\n    </p>\n  );\n}\n```\n\n## Arquivos de Tradução\n\n### 1. Estrutura JSON\n```json\n// src/lib/i18n/locales/pt/dashboard.json\n{\n  \"welcomeMessage\": \"Bem-vindo ao Dashboard\",\n  \"description\": \"Olá {{name}}, aqui está o seu resumo\",\n  \"stats\": {\n    \"clients\": \"Clientes Ativos\",\n    \"orders\": \"Ordens de Serviço\",\n    \"revenue\": \"Receita Mensal\"\n  },\n  \"actions\": {\n    \"addClient\": \"Adicionar Cliente\",\n    \"viewReports\": \"Ver Relatórios\"\n  }\n}\n```\n\n### 2. Pluralização\n```json\n{\n  \"notifications\": \"Você tem {{count}} notificação\",\n  \"notifications_plural\": \"Você tem {{count}} notificações\"\n}\n```\n\n```tsx\nconst { t } = useTranslation();\n<span>{t('notifications', { count: 5 })}</span>\n```\n\n## Roteamento com Idiomas\n\n### 1. Estrutura de Rotas\n```\nsrc/app/\n├── [locale]/\n│   ├── page.tsx          # /pt/, /en/, /es/\n│   ├── dashboard/\n│   │   └── page.tsx      # /pt/dashboard, /en/dashboard, etc.\n│   └── ...\n├── middleware.ts         # Detecção de idioma\n└── ...\n```\n\n### 2. Middleware de Detecção\n```typescript\n// src/app/middleware.ts\nimport { i18nRouter } from 'next-i18n-router';\nimport i18nConfig from '@/lib/i18n/config';\n\nexport function middleware(request: NextRequest) {\n  return i18nRouter(request, i18nConfig);\n}\n\nexport const config = {\n  matcher: ['/((?!api|static|.*\\..*|_next).*)']\n};\n```\n\n### 3. Layout com Configuração de Idioma\n```tsx\n// src/app/[locale]/layout.tsx\nimport { dir } from 'i18next';\nimport { languages } from '@/lib/i18n/config';\n\nexport function generateStaticParams() {\n  return languages.map((lng) => ({ lng }));\n}\n\nexport default function LocaleLayout({\n  children,\n  params: { lng }\n}: {\n  children: React.ReactNode;\n  params: { lng: string };\n}) {\n  return (\n    <html lang={lng} dir={dir(lng)}>\n      <body>{children}</body>\n    </html>\n  );\n}\n```\n\n## Formatação de Dados\n\n### 1. Datas e Números\n```tsx\nimport { useTranslation } from 'react-i18next';\n\nexport default function FormattedData() {\n  const { t, i18n } = useTranslation();\n  const date = new Date();\n  \n  // Formatação de data\n  const formattedDate = new Intl.DateTimeFormat(i18n.language).format(date);\n  \n  // Formatação de moeda\n  const formattedCurrency = new Intl.NumberFormat(i18n.language, {\n    style: 'currency',\n    currency: 'BRL'\n  }).format(1234.56);\n  \n  return (\n    <div>\n      <p>{t('lastUpdated')}: {formattedDate}</p>\n      <p>{t('totalAmount')}: {formattedCurrency}</p>\n    </div>\n  );\n}\n```\n\n## Detecção de Idioma\n\n### 1. Ordem de Prioridade\n1. Parâmetro de URL (`/en/dashboard`)\n2. Cookie de preferência do usuário\n3. Header `Accept-Language` do navegador\n4. Idioma padrão da aplicação\n\n### 2. Seleção Manual de Idioma\n```tsx\n'use client'\nimport { usePathname, useRouter } from 'next/navigation';\nimport { useTranslation } from 'react-i18next';\n\nexport default function LanguageSwitcher() {\n  const pathname = usePathname();\n  const router = useRouter();\n  const { i18n } = useTranslation();\n  \n  const changeLanguage = (lng: string) => {\n    // Atualizar idioma no i18n\n    i18n.changeLanguage(lng);\n    \n    // Redirecionar para a mesma página no novo idioma\n    const newPath = pathname.replace(/^\\/[a-z]{2}/, `/${lng}`);\n    router.push(newPath);\n  };\n  \n  return (\n    <select \n      value={i18n.language} \n      onChange={(e) => changeLanguage(e.target.value)}\n    >\n      <option value=\"pt\">Português</option>\n      <option value=\"en\">English</option>\n      <option value=\"es\">Español</option>\n    </select>\n  );\n}\n```\n\n## Adicionando Novos Idiomas\n\n### 1. Passos Necessários\n1. Criar nova pasta em `src/lib/i18n/locales/` com código do idioma\n2. Criar arquivos JSON de tradução para cada namespace\n3. Adicionar idioma ao array `locales` em `config.ts`\n4. Atualizar componentes de seleção de idioma\n\n### 2. Exemplo de Adição\n```bash\n# Criar estrutura para francês\nmkdir src/lib/i18n/locales/fr\ncp src/lib/i18n/locales/pt/*.json src/lib/i18n/locales/fr/\n# Traduzir os arquivos JSON\n```\n\n```typescript\n// src/lib/i18n/config.ts\nexport const i18n = {\n  defaultLocale: 'pt',\n  locales: ['pt', 'en', 'es', 'fr'], // Adicionar 'fr'\n} as const;\n```\n\n## Boas Práticas\n\n### 1. Chaves de Tradução\n- Utilizar chaves descritivas e organizadas por funcionalidade\n- Evitar chaves genéricas como \"button1\", \"text2\"\n- Manter consistência na nomenclatura\n\n### 2. Textos em Componentes\n- Evitar textos hardcoded em componentes\n- Extrair todos os textos para arquivos de tradução\n- Utilizar variáveis para conteúdo dinâmico\n\n### 3. Manutenção\n- Manter todos os idiomas sincronizados\n- Criar processo de revisão de traduções\n- Utilizar ferramentas de tradução quando possível\n\n### 4. Performance\n- Carregar apenas o idioma necessário\n- Utilizar code splitting para recursos de tradução\n- Cachear traduções quando apropriado\n\n### 5. SEO\n- Implementar hreflang tags para SEO\n- Utilizar URLs canônicas corretas\n- Garantir conteúdo indexável em todos os idiomas\n\n## Testes de Internacionalização\n\n### 1. Testes Unitários\n```tsx\n// Testar componentes com diferentes idiomas\nimport { render, screen } from '@testing-library/react';\nimport { I18nextProvider } from 'react-i18next';\nimport i18n from '@/lib/i18n';\n\ndescribe('Componente Internacionalizado', () => {\n  it('deve mostrar texto em português', () => {\n    i18n.changeLanguage('pt');\n    render(\n      <I18nextProvider i18n={i18n}>\n        <Component />\n      </I18nextProvider>\n    );\n    \n    expect(screen.getByText('Bem-vindo')).toBeInTheDocument();\n  });\n});\n```\n\n### 2. Testes E2E\n- Verificar funcionalidade em diferentes idiomas\n- Testar troca de idioma\n- Validar formatação de datas e números\n\n## Ferramentas Recomendadas\n\n### 1. Gerenciamento de Traduções\n- **Locize** - Plataforma de gerenciamento de traduções\n- **Crowdin** - Ferramenta de localização colaborativa\n- **Phrase** - Sistema de gerenciamento de traduções\n\n### 2. Extração de Textos\n- **i18next-parser** - Extrai chaves de tradução do código\n- **babel-plugin-i18next-extract** - Plugin Babel para extração\n\n### 3. Validação\n- Scripts para verificar chaves não utilizadas\n- Scripts para verificar chaves faltando em algum idioma\n